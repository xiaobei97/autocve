# CVE数据抓取与处理工具

> 本项目由 Cursor AI 协助开发，用于自动化抓取和处理CVE漏洞数据。

## 项目简介

这是一个自动化工具，用于从[cvefeed.io](https://cvefeed.io)抓取指定日期范围内的CVE漏洞数据，并将结果以格式化的Excel表格形式输出。该工具特别适合安全研究人员、系统管理员和开发人员用于跟踪和分析软件组件的安全漏洞。

## ✨ 功能特点

### 核心功能
- 🗓️ **交互式日期范围选择**
- 📦 **支持批量处理多个组件**
- 🔍 **自动抓取CVSS评分≥7.0的高危漏洞**
- 📊 **生成美观的Excel报告**
- 🇨🇳 **支持中文界面和输出**

### 🎯 智能过滤功能（新增）
- **精确匹配算法**：使用单词边界匹配，避免子字符串误匹配
- **智能别名映射**：自动为30+常见组件选择最佳搜索词
- **多字段验证**：对CVE描述、编号、参考链接进行相关性验证
- **智能过滤报告**：显示原始数量vs过滤后数量的对比

### 🎨 输出格式优化
- 自动合并相同组件的单元格
- 智能数据清洗和格式化
- 自动调整列宽和行高
- 专业的表格样式设计

## 技术栈

- Python 3.x
- requests - HTTP请求处理
- pandas - 数据处理
- openpyxl - Excel文件操作
- brotli - 数据解压缩

## 安装说明

1. 确保已安装Python 3.x
2. 安装所需依赖：
```bash
pip install requests pandas openpyxl brotli
```

## 📝 配置文件格式

创建名为`components.txt`的配置文件，支持两种格式：

### 1. 简单格式
```text
# 每行一个组件名，程序会自动添加常见别名
elasticsearch
nginx
mysql
spring
react
```

### 2. 配置格式（推荐用于容易混淆的组件）
```text
# 组件名:自定义搜索词1,搜索词2,搜索词3
poi: apache poi, poi library
log4j: apache log4j, log4j2
spring: spring framework, springframework
jackson: jackson-databind, fasterxml jackson
node: node.js, nodejs
go: golang, go language
vue: vue.js, vuejs framework
```

### 配置说明
- 以`#`开头的行为注释，会被忽略
- 空行会被自动过滤
- 建议对短词组件（如poi、go、vue）使用配置格式
- 对明确的组件名使用简单格式即可

## 🚀 使用方法

1. **准备配置文件**：
   按上述格式创建`components.txt`文件

2. **运行脚本**：
```bash
python cve_workflow.py
```

3. **按提示操作**：
   - 输入开始日期（格式：YYYY-MM-DD）
   - 输入结束日期（格式：YYYY-MM-DD）
   - 确认开始抓取数据

4. **查看结果**：
   - 脚本会自动生成Excel文件
   - 文件名格式：`cve_results_YYYYMMDD_HHMMSS.xlsx`

## 📊 智能过滤效果示例

程序运行时会显示详细的过滤信息：

```
正在获取组件 poi 的CVE数据...
使用搜索词: apache poi

正在处理组件 poi 的漏洞数据...
过滤掉不相关的漏洞: CVE-2024-12345
过滤掉不相关的漏洞: CVE-2024-67890
组件 poi: 原始漏洞 15 个，过滤后 3 个

结果已成功保存到 cve_results_20241201_143022.xlsx 文件中
```

## 📄 输出格式

生成的Excel文件包含以下列：
- **组件名称**（自动合并相同组件）
- **CVE编号**
- **发布时间**
- **漏洞描述**（自动换行）

### 格式特点：
- 🎨 蓝色表头 + 白色字体
- 📏 自动调整列宽和行高
- 🔲 完整的单元格边框
- 📍 文本居中对齐
- 📝 描述列自动换行

## ⚠️ 注意事项

1. **网络要求**：确保网络连接正常
2. **日期格式**：必须为YYYY-MM-DD格式
3. **日期逻辑**：结束日期不能早于开始日期
4. **组件命名**：建议使用官方或常见名称
5. **过滤标准**：默认只抓取CVSS评分≥7.0的漏洞
6. **精确匹配**：对于容易混淆的短词，建议使用配置格式指定精确搜索词

## 🛡️ 错误处理

脚本包含完善的错误处理机制：
- ✅ 日期格式验证
- 🌐 网络请求异常处理
- 📄 数据解析错误处理
- 💾 文件操作错误处理
- 🔍 CVE相关性验证

## 🤝 贡献指南

欢迎提交Issue和Pull Request来改进这个项目。在提交之前，请确保：
1. 代码符合PEP 8规范
2. 添加适当的注释
3. 更新相关文档
4. 测试新功能

## 📜 许可证

本项目采用MIT许可证。详见LICENSE文件。

## 🙏 致谢

感谢[cvefeed.io](https://cvefeed.io)提供的数据接口。

## 📞 联系方式

如有问题或建议，请通过GitHub Issues提交。 